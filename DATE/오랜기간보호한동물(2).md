## **ì˜¤ëœ ê¸°ê°„ ë³´í˜¸í•œ ë™ë¬¼(2)**

ğŸ”’ [ë¬¸ì œ ë³´ê¸°](https://programmers.co.kr/learn/courses/30/lessons/59411)

ğŸ”‘ í’€ì´ ë‹µì•ˆ - Oracle

```SQL
SELECT c.animal_id, c.name
FROM ( SELECT b.animal_id
              , b.name
              , b.datetime - a.datetime diff
       FROM animal_ins a, animal_outs b
       WHERE a.animal_id = b.animal_id
       ORDER BY diff desc
      ) c
WHERE ROWNUM <= 2
```

```SQL
SELECT c.animal_id, c.name
FROM ( SELECT b.animal_id
              , b.name
              , ROW_NUMBER() OVER(ORDER BY b.datetime - a.datetime DESC) diff
       FROM animal_ins a, animal_outs b
       WHERE a.animal_id = b.animal_id
      ) c
WHERE c.diff <= 2
```

------

#### ğŸ’¡ ROW_NUMBER()

- í˜•ì‹
  - ROW_NUMBER() OVER(PARTITION BY [Groupping Column] ORDER BY [Ordering Column])
- ì¤‘ë³µì— ëŒ€í•œ ìˆœìœ„ ì²˜ë¦¬ê°€ ì—†ê³  ëª¨ë“  ê°’ì€ ìœ ì¼í•œ ê°’ì„ ê°€ì§„ë‹¤.
  - ì¦‰, ê°’ì´ ê°™ë”ë¼ë„ ê³ ìœ í•œ ìˆœìœ„ë¥¼ ë¶€ì—¬í•œë‹¤.